
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Method of Relaxation in 2d &#8212; PHY 415 Fall 2023</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">PHY 415 Fall 2023</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to Mathematical Modeling in Physics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  0 - Intro and Syllabus
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../0_course/0_syllabus.html">
   Syllabus and Overview of PHY 415
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../0_course/1_goals.html">
     Course Objectives
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../0_course/2_design.html">
     Course Design
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../0_course/3_assessments.html">
     Assessments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../0_course/4_rubric.html">
     Project Rubrics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../0_course/5_calendar.html">
     Calendar
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../0_course/6_environment.html">
     Classroom Environment
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../0_course/7_resources.html">
     Resources
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../0_course/8_worked_problems.html">
     Worked Problems
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  1 - Mechanics and ODEs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/modeling/activity-what_is_a_model.html">
   29 Aug 23 - Activity: What is a Model?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/sho/notes-SHO.html">
   29 Aug 23 - Notes: Simple Harmonic Oscillator
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/lagrangian/notes_frames.html">
   31 Aug 23 - Notes: Frames and Coordinates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/lagrangian/frames.html">
   31 Aug 23 - Activity: Frames and Coordinates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/lagrangian/notes-lagrangian-dynamics.html">
   5 Sept 23 - Notes: Lagrangian Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/lagrangian/activity-lagrange_1.html">
   5 Sep 23 - Activity: Calculus of Variations and Lagrangian Dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/lagrangian/notes-numerical_integration_1d.html">
   7 Sept 23 - Notes: Numerical Integration in 1D
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/lagrangian/activity-lagrange_2.html">
   7 Sep 23 - Activity: Numerical Integration and More Lagrangians
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/dynamical_systems/notes-phase_space.html">
   12 Sept 23 - Notes: Dynamical Systems and Phase Space
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/dynamical_systems/activity-phase_space.html">
   12 Sep 23 - Activity: The Dynamical Systems Approach and Phase Portraits
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/dynamical_systems/activity-vanderpol.html">
   14 Sept 23 - Activity: Conducting a complete analysis of an ODE
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/dynamical_systems/notes-linearization_odes.html">
   19 Sep 23 - Notes: Heading towards Chaos
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_mechanics/dynamical_systems/activity-duffing.html">
   19 Sep 23 - The Duffing Oscillator
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  2 - E&amp;M and PDEs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Statics/notes-em_intro.html">
   26 Sept 23 - Notes: Maxwell’s Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Statics/notes-static_fields.html">
   26 Sept 23 - Notes: Static Fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Statics/activity-efields.html">
   26 Sep 23 - Activity: Electrostatic Fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Statics/activity-superposition.html">
   28 Sep 23 - Activity: Superposition of Fields
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Statics/notes-electric_potential.html">
   3 Oct 23 - Notes: Electric Potential - a scalar field
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Statics/activity-sep_var.html">
   3 Oct 23 - Activity: PDEs and Separation of Variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Statics/activity-sep_var_spherical.html">
   5 Oct 2023 - Activity: Solving PDEs in Spherical Coordinates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notes-relaxation.html">
   9 Oct 23 - Notes: Method of Relaxation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Statics/activity-sep_var_spherical_examples.html">
   10 Oct 2023 - Activity: Matching Boundary Conditions and Plotting the Potential
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  3 - Waves and Oscillations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../3_waves/notes-coupled_oscillations.html">
   16 Oct 23 - Notes: Coupled Oscillations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../3_waves/notes-waves_intro.html">
   16 Oct 23 - Notes: Introduction to Waves
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Assignments
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../9_assignments/worked-problem-1.html">
   Worked Problem Assignment 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../9_assignments/worked-problem-2.html">
   Worked Problem Assignment 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../9_assignments/project-1.html">
   Project 1 - Classical Mechanics and ODEs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../9_assignments/worked-problem-3.html">
   Worked Problem Assignment 3
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../9_assignments/worked-problem-4.html">
   Worked Problem Assignment 4
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../9_assignments/project-2.html">
   Project 2 - PDEs, Laplace’s Equation, and the Method of Relaxation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../references.html">
   Works Cited
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/valentine-alia/phy415fall23/master?urlpath=tree/content/2_EM/Numerics/activity-relaxation_2d.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/valentine-alia/phy415fall23"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/valentine-alia/phy415fall23/issues/new?title=Issue%20on%20page%20%2Fcontent/2_EM/Numerics/activity-relaxation_2d.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/content/2_EM/Numerics/activity-relaxation_2d.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementing-the-method-in-python">
   Implementing the method in python:
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Method of Relaxation in 2d</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementing-the-method-in-python">
   Implementing the method in python:
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="method-of-relaxation-in-2d">
<h1>Method of Relaxation in 2d<a class="headerlink" href="#method-of-relaxation-in-2d" title="Permalink to this headline">#</a></h1>
<p>Maxwell’s equations give us Laplace’s equation for potential <span class="math notranslate nohighlight">\(\phi\)</span> with no source charges:</p>
<div class="math notranslate nohighlight">
\[\nabla^2 \phi = 0 \]</div>
<p>in 2d this reads:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 \phi}{\partial x^2} + \frac{\partial^2 \phi}{\partial y^2} = 0.
\]</div>
<p>We’re choosing the 2d version simply because it is nicer to visualize. Since this is a PDE, we need to specify <strong>boundary conditions</strong> for <span class="math notranslate nohighlight">\(\phi\)</span> along the edges of the box as opposed to initial conditions like we’ve seen for ODEs. Let’s choose <span class="math notranslate nohighlight">\(\phi = V\)</span> along the top of the box and <span class="math notranslate nohighlight">\(\phi = 0\)</span> on the other sides.</p>
<p>Numerically we can approximate the 2nd partial x derivative of <span class="math notranslate nohighlight">\(\phi\)</span> as:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 \phi}{\partial x^2} \approx \frac{\phi(x+h,y) + \phi(x-h,y) - 2\phi(x,y)}{h^2}
\]</div>
<p>for some small positive real number <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>We can write this for the y direction as well:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 \phi}{\partial y^2} \approx \frac{\phi(x,y+h) + \phi(x,y-h) - 2\phi(x,y)}{h^2}
\]</div>
<p>Adding these gives us Laplace’s equation:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 \phi}{\partial x^2} + \frac{\partial^2 \phi}{\partial y^2}  = \frac{\phi(x+h,y) + \phi(x-h,y) - 2\phi(x,y) + \phi(x,y+h) + \phi(x,y-h) - 2\phi(x,y)}{h^2} = 0 
\]</div>
<p>or more simply:</p>
<div class="math notranslate nohighlight">
\[
\phi(x+h,y) + \phi(x-h,y) + \phi(x,y+h) + \phi(x,y-h) - 4\phi(x,y)= 0 
\]</div>
<p>We want to know <span class="math notranslate nohighlight">\(\phi(x,y)\)</span> and this equation thankfully has a <span class="math notranslate nohighlight">\(\phi(x,y)\)</span> term so we can solve for it:</p>
<div class="math notranslate nohighlight">
\[
\phi(x,y) = \frac{1}{4}\left[\phi(x+h,y) + \phi(x-h,y) + \phi(x,y+h) + \phi(x,y-h) \right]
\]</div>
<p>This is saying that we can approximate <span class="math notranslate nohighlight">\(\phi(x,y)\)</span> by the average of the grid points that surround it, which should feel intuitive. Here comes the clever bit for how we turn this into a solver - We first the boundary points of our grid to our boundary conditions and set all the interior points to zero. Then we use this equation to update each interior point by its neighbors, that is:</p>
<div class="math notranslate nohighlight">
\[
\phi_{k+1}(x,y) = \frac{1}{4}\left[\phi_{k}(x+h,y) + \phi_{k}(x-h,y) + \phi_{k}(x,y+h) + \phi_{k}(x,y-h) \right]
\]</div>
<p>Then we iterate this process, for many values of <span class="math notranslate nohighlight">\(i\)</span> until our system converges (If it converges! This method isn’t garunteed to converge.). To check for convergence, we can calculate the change <span class="math notranslate nohighlight">\(\delta = |\phi_{k+1}(x,y) - \phi(x,y)|\)</span> and terminate the algorithm when <span class="math notranslate nohighlight">\(\delta\)</span> is sufficiently small.</p>
<section id="implementing-the-method-in-python">
<h2>Implementing the method in python:<a class="headerlink" href="#implementing-the-method-in-python" title="Permalink to this headline">#</a></h2>
<p>Let’s choose <span class="math notranslate nohighlight">\(V = 1\)</span> volt with a grid spacing of <span class="math notranslate nohighlight">\(h = 0.01 m\)</span> and a box with <span class="math notranslate nohighlight">\(1m\)</span> long sides. Some code for the relaxation method might look like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># constants and parameters</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">V</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-5</span>

<span class="c1"># setup phi, phiprime arrays</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">phiprime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="c1"># to play the part of phi (k+1)</span>

<span class="c1"># boundary condition</span>
<span class="n">phi</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">V</span> 

<span class="n">k</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># track number of iterations</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># initial delta</span>

<span class="k">while</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span> <span class="c1"># run until converged</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="n">N</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span>  <span class="n">j</span> <span class="o">==</span> <span class="n">N</span><span class="p">:</span> <span class="c1"># don&#39;t update boundary</span>
                <span class="n">phiprime</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># relaxation update equation</span>
                <span class="n">phiprime</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> 

    <span class="c1"># find max difference for delta</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phi</span><span class="o">-</span><span class="n">phiprime</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

    <span class="c1"># swap arrays to keep iterating</span>
    <span class="n">phi</span><span class="p">,</span><span class="n">phiprime</span> <span class="o">=</span> <span class="n">phiprime</span><span class="p">,</span><span class="n">phi</span> 
    
    <span class="c1"># track iterations</span>
    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="k">500</span> == 0 or k ==1:
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;iter:&quot;</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="s2">&quot;delta:&quot;</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>         
    <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phi</span><span class="o">-</span><span class="n">phiprime</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter: 1 delta: 0.25
iter: 500 delta: 0.00048243008996595727
iter: 1000 delta: 0.000229620021960808
iter: 1500 delta: 0.00013941050635341012
iter: 2000 delta: 9.341822623809559e-05
iter: 2500 delta: 6.633821733703638e-05
iter: 3000 delta: 4.888935877228606e-05
iter: 3500 delta: 3.692387262205221e-05
iter: 4000 delta: 2.831349421716922e-05
iter: 4500 delta: 2.191311604954338e-05
iter: 5000 delta: 1.7041162018283096e-05
iter: 5500 delta: 1.3277936764283238e-05
iter: 6000 delta: 1.0364656696432162e-05
6073
</pre></div>
</div>
<img alt="../../../_images/activity-relaxation_2d_3_1.png" src="../../../_images/activity-relaxation_2d_3_1.png" />
</div>
</div>
<p>Now we can “upgrade” to the Poisson equation:</p>
<div class="math notranslate nohighlight">
\[\nabla^2 \phi = -\frac{\rho}{\epsilon_0}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\rho\)</span> is a <strong>charge density</strong>.</p>
<p>Substituting our 2nd partial derivative equations gives us:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 \phi}{\partial x^2} + \frac{\partial^2 \phi}{\partial y^2}  = \frac{\phi(x+h,y) + \phi(x-h,y) - 2\phi(x,y) + \phi(x,y+h) + \phi(x,y-h) - 2\phi(x,y)}{h^2} = -\frac{\rho}{\epsilon_0}
\]</div>
<p>Which in turn gives us the update equation:</p>
<div class="math notranslate nohighlight">
\[
\phi_{k+1}(x,y) = \frac{1}{4}\left[\phi_{k}(x+h,y) + \phi_{k}(x-h,y) + \phi_{k}(x,y+h) + \phi_{k}(x,y-h) \right] + \frac{h^2}{4\epsilon_0} \rho(x,y)
\]</div>
<p>With a couple minor edits to our previous code, we can implement this (warning: this takes a long time to converge).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># constants and parameters</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">V</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">epsilon0</span> <span class="o">=</span> <span class="mf">8.854e-12</span>

<span class="c1"># setup phi, phiprime arrays</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="n">phiprime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="c1"># to play the part of phi (k+1)</span>

<span class="k">def</span> <span class="nf">rho</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">h</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">j</span> <span class="o">*</span> <span class="n">h</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mf">0.6</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mf">0.8</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mf">0.2</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="mf">0.4</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.01</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mf">0.2</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mf">0.4</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mf">0.6</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&lt;=</span> <span class="mf">0.8</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">0.01</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># track number of iterations</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># initial delta</span>

<span class="k">while</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="n">tol</span><span class="p">:</span> <span class="c1"># run until converged</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">i</span> <span class="o">==</span> <span class="n">N</span> <span class="ow">or</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span>  <span class="n">j</span> <span class="o">==</span> <span class="n">N</span><span class="p">:</span> <span class="c1"># don&#39;t update boundary</span>
                <span class="n">phiprime</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># relaxation update equation</span>
                <span class="n">phiprime</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">h</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">epsilon0</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>

    <span class="c1"># find max difference for delta</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phi</span><span class="o">-</span><span class="n">phiprime</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

    <span class="c1"># swap arrays to keep iterating</span>
    <span class="n">phi</span><span class="p">,</span><span class="n">phiprime</span> <span class="o">=</span> <span class="n">phiprime</span><span class="p">,</span><span class="n">phi</span> 
    
    <span class="c1"># track iterations</span>
    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">k</span><span class="o">%</span><span class="k">500</span> == 0 or k ==1:
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;iter:&quot;</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="s2">&quot;delta:&quot;</span><span class="p">,</span><span class="n">delta</span><span class="p">)</span>         
    <span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">phi</span><span class="o">-</span><span class="n">phiprime</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>iter: 1 delta: 28235.825615541005
iter: 500 delta: 6832.1411354132
iter: 1000 delta: 3251.0140515118837
iter: 1500 delta: 1711.4857647046447
iter: 2000 delta: 917.3925458248705
iter: 2500 delta: 493.9909758400172
iter: 3000 delta: 266.3548976704478
iter: 3500 delta: 143.67581759020686
iter: 4000 delta: 77.51158285886049
iter: 4500 delta: 41.818661987781525
iter: 5000 delta: 22.562173744663596
iter: 5500 delta: 12.172908741980791
iter: 6000 delta: 6.567631067708135
iter: 6500 delta: 3.5434269327670336
iter: 7000 delta: 1.9117818996310234
iter: 7500 delta: 1.0314620584249496
iter: 8000 delta: 0.5565038658678532
iter: 8500 delta: 0.30025007389485836
iter: 9000 delta: 0.16199367865920067
iter: 9500 delta: 0.08740031719207764
iter: 10000 delta: 0.047155024483799934
iter: 10500 delta: 0.02544150874018669
iter: 11000 delta: 0.013726437464356422
iter: 11500 delta: 0.007405813783407211
iter: 12000 delta: 0.0039956532418727875
iter: 12500 delta: 0.002155773341655731
iter: 13000 delta: 0.0011631026864051819
iter: 13500 delta: 0.0006275307387113571
iter: 14000 delta: 0.0003385692834854126
iter: 14500 delta: 0.0001826714724302292
iter: 15000 delta: 9.85562801361084e-05
iter: 15500 delta: 5.31710684299469e-05
iter: 16000 delta: 2.86884605884552e-05
iter: 16500 delta: 1.5478581190109253e-05
16855
</pre></div>
</div>
<img alt="../../../_images/activity-relaxation_2d_5_1.png" src="../../../_images/activity-relaxation_2d_5_1.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/2_EM/Numerics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Danny Caballero, Alia Valentine<br/>
  
      &copy; Copyright 2023.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>